'use client';
var jsxRuntime = require('react/jsx-runtime');
var React = require('react');
var actions12s = require('./actions-12s-CuAyAEDg.cjs');
var tabs12s = require('./tabs-12s-CnTP-tdP.cjs');
var index_cjs = require('../widgets/index.cjs');
var context12s = require('./context-12s-Bd_RtAfM.cjs');

function CodeArtifactViewer({ className, tabs }) {
    const { displayedArtifact, updateArtifact } = context12s.useChatCanvas();
    const [updatedCode, setUpdatedCode] = React.useState();
    if ((displayedArtifact == null ? void 0 : displayedArtifact.type) !== 'code') return null;
    const codeArtifact = displayedArtifact;
    const handleCodeChange = (newValue)=>{
        setUpdatedCode(newValue);
    };
    const handleSaveChanges = ()=>{
        if (!updatedCode) return;
        setUpdatedCode(undefined);
        updateArtifact(codeArtifact, updatedCode);
    };
    var _codeArtifact_data_file_name_split_pop;
    const codeEditorLanguage = index_cjs.fileExtensionToEditorLang((_codeArtifact_data_file_name_split_pop = codeArtifact.data.file_name.split('.').pop()) != null ? _codeArtifact_data_file_name_split_pop : '');
    return /*#__PURE__*/ jsxRuntime.jsxs(tabs12s.Tabs, {
        defaultValue: "code",
        className: actions12s.cn('flex h-full min-h-0 flex-1 flex-col gap-4 p-4', className),
        children: [
            /*#__PURE__*/ jsxRuntime.jsxs("div", {
                className: "flex items-center justify-between",
                children: [
                    /*#__PURE__*/ jsxRuntime.jsxs(tabs12s.TabsList, {
                        children: [
                            /*#__PURE__*/ jsxRuntime.jsx(tabs12s.TabsTrigger, {
                                value: "code",
                                children: "Code"
                            }),
                            tabs && Object.entries(tabs).map(([key])=>/*#__PURE__*/ jsxRuntime.jsx(tabs12s.TabsTrigger, {
                                    value: key,
                                    className: "capitalize",
                                    children: key
                                }, key))
                        ]
                    }),
                    /*#__PURE__*/ jsxRuntime.jsx(actions12s.ChatCanvasActions, {})
                ]
            }),
            /*#__PURE__*/ jsxRuntime.jsxs("div", {
                className: "min-h-0 flex-1 overflow-auto pr-2",
                children: [
                    /*#__PURE__*/ jsxRuntime.jsxs(tabs12s.TabsContent, {
                        value: "code",
                        className: "relative h-full",
                        children: [
                            /*#__PURE__*/ jsxRuntime.jsx(index_cjs.CodeEditor, {
                                code: updatedCode != null ? updatedCode : codeArtifact.data.code,
                                onChange: handleCodeChange,
                                language: codeEditorLanguage
                            }),
                            updatedCode && /*#__PURE__*/ jsxRuntime.jsxs("div", {
                                className: "bg-background absolute right-0 top-0 flex gap-2 pr-2 text-sm",
                                children: [
                                    /*#__PURE__*/ jsxRuntime.jsx(actions12s.Button, {
                                        size: "sm",
                                        className: "h-7 bg-blue-500 hover:bg-blue-600",
                                        onClick: handleSaveChanges,
                                        children: "Save"
                                    }),
                                    /*#__PURE__*/ jsxRuntime.jsx(actions12s.Button, {
                                        variant: "outline",
                                        size: "sm",
                                        className: "h-7",
                                        onClick: ()=>setUpdatedCode(undefined),
                                        children: "Revert"
                                    })
                                ]
                            })
                        ]
                    }),
                    tabs && Object.entries(tabs).map(([key, value])=>/*#__PURE__*/ jsxRuntime.jsx(tabs12s.TabsContent, {
                            value: key,
                            className: "h-full",
                            children: value
                        }, key))
                ]
            })
        ]
    });
}

exports.CodeArtifactViewer = CodeArtifactViewer;
